//For  user authentication

router.post('/login', async (req,res) => {/*/login is the link for backend Server*/
    const user = await User.findOne({email: req.body.email})//Use User method to find one user by id 
    
    if(!user) {
        return res.status(400).send('The user not found');
    }

    if(user && bcrypt.compareSync(req.body.password, user.passwordHash)) {
        //comparining entered password with data-base pass
        const token = jwt.sign(
            {
                userId: user.id,
                isAdmin: user.isAdmin
            },
            '1236xxx'/*Secret Key*/ ,
            {expiresIn : '1d'}//Token will get Expire in one Day 
        )
       
        res.status(200).send({user: user.email , token: token}) //status(200)show that req is succeeded
    } else {
       res.status(400).send('password is wrong!');
    }

    
})